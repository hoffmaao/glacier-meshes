
This repository contains scripts for fetching and processing various glaciological data sets.
These data sets are the inputs to several demo programs for the glacier flow modeling library [icepack](https://www.github.com/icepack/icepack).
These demo programs assume that the environment variable `ICEPACK_DATA` is set to the path to the current directory.

### Contents

The directory `regions` contains geojson files describing bounding boxes for interesting regions of various ice sheets.
The directory `scripts` contains assorted shell scripts for things like fetching data over HTTPS from NSIDC, normalizing a geojson file, and so forth.

Every other directory is for some specific data set, e.g. the Bedmap2 digital elevation model of Antarctica, the MEaSUREs velocity maps of Antarctica and Greenland, etc.
These consist of a makefile that should take care of everything; just change into the directory and type `make`.

The primary function of these scripts is to subdivide the original data set into smaller data sets for each region or glacier.
The original data sets often cover entire ice sheets, and the time necessary to load and parse a map of the entire ice sheet can dominate the simulation time for an individual region.
Additionally, some data sets have small missing patches that can be filled in with reasonable values using some interpolation scheme.


### NSIDC

Many of the data sources are hosted by the [National Snow and Ice Data Center](https://nsidc.org).
NSIDC requires that you register with [NASA EarthData](https://earthdata.nasa.gov) to download many of the data sets that they host.
If you're using Mac/Unix/Linux, you can set up a `.netrc` file with your login credentials for NASA to enable downloading files from EarthData using the command line tools cURL or wget.
Instructions for setting up a `.netrc` file can be found [here](https://nsidc.org/support/faq/what-options-are-available-bulk-downloading-data-https-earthdata-login-enabled).
The fetch scripts in this repository assume that you've already done this.

Alternatively, the makefile for each data source will not download the raw data again if the file is already present.
If you've already downloaded the relevant raw data, you can copy it into the corresponding folder in this repository, or create a symbolic link to where the file is located on your machine.
Then the fetch script won't bother downloading it again.


### Dependencies

* cURL
* Python 3
* numpy, scipy
* osgeo
* GDAL
* rasterio
* netCDF
* geojson
* zlib
* gmsh-2.12 or later
* [icepack](http://github.com/icepack/icepack.git)

Make sure that you have a recent version of gmsh -- 2.12 or above.
The quad meshes generated by gmsh-2.11 are generally of much lower quality, to the point that finite element solvers can fail to converge.
The all-quad meshing algorithm was substantially improved in gmsh-2.12.

